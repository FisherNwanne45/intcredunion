//tealium universal tag - utag.307 ut4.0.202001230931, Copyright 2020 Tealium.com Inc. All Rights Reserved.
var vscr=vscr||[];try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1};u.map_func=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.map_func(arr,obj[i],item);}else{obj[i]=item;}};u.isEmpty=function(object){for(var key in object){if(object.hasOwnProperty(key))
return false;}
return true;};u.map={};u.extend=[function(a,b){try{if(1){if(/.*\/sainsburysbank\/portal\/default\/pc\/registerportalusernb\.page/i.test(location.pathname)){(function(){vscr.push(["addEvent",{name:"Car Insurance Sale",revenue:dataLayer[0].premium_value.replace("£",""),transactionId:ck("yd_saleRef")||"",details:[{name:"Car Insurance",sku:dataLayer[0].product_type,quantity:utag_data["PRODUCTS_quantity"],cost:dataLayer[0].premium_value.replace("£","")}]}]);})();}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(/.*insurance\-sainsburysbank\.co\.uk\/confirmation.*/i.test(window.location.href)){(function(){vscr.push(["addEvent",{name:"Travel Insurance Sale",revenue:utag.data['confirmation_price'].replace('£','')||"",transactionId:utag.data['policy_number'],details:[{name:"Travel Insurance",sku:utag.data['product_type'],quantity:"1",cost:utag.data['confirmation_price'].replace('£','')||""}]}]);})();}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(/travelmoney\.sainsburysbank\.co\.uk\/sainsburys\/confirm/i.test(window.location.href)){(function(){vscr.push(["addEvent",{name:"Travel Money Sale",revenue:utag.data['cp.yrd_numberofpounds'],transactionId:$('.sub-header h3').text().trim().split(' ').pop(),details:[{name:"Travel Money",sku:"",quantity:"1",cost:utag.data['cp.yrd_numberofpounds']}]}]);})();}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(/\/apply\/apply\/creditcards\/offer/i.test(location.pathname)||/\/apply\/apply\/creditcardapplication\#\/creditcardoffer/i.test(location.href)||/\/apply\/apply\/creditcardapplication\/refer/i.test(location.pathname)||/\/apply\/apply\/creditcardapplication\/decline/i.test(location.pathname)||/online\.sainsburysbank\.co\.uk\/servicing\/servicing\/creditcardapplication\/declined/i.test(location.pathname)||/online\.sainsburysbank\.co\.uk\/servicing\/servicing\/creditcardapplication\/referred/i.test(location.pathname)){(function(){var current_path=location.href.replace(location.protocol+"//"+location.hostname,"");if(current_path=="/apply/apply/creditcards/offer"||/apply\/apply\/creditcardapplication\#\/creditcardoffer/i.test(location.href)){credit_card_outcome="Accepted";}else if((current_path=="/apply/apply/creditcardapplication/decline")||(current_path=="/servicing/servicing/creditcardapplication/declined")){credit_card_outcome="Declined";}else if((current_path=="/apply/apply/creditcardapplication/refer")||(current_path=="/servicing/servicing/creditcardapplication/referred")){credit_card_outcome="Referred";}
vscr.push(["addEvent",{name:"Credit Card Sale",revenue:"0",transactionId:"0",details:[{name:"Credit Card "+credit_card_outcome,sku:"",quantity:"1",cost:"0"}]}]);})();}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(/.*savings(complete|application)\/success/i.test(location.pathname)||/.*savings(complete|application)\/referred/i.test(location.pathname)){(function(){vscr.push(["addEvent",{name:"Savings Sale",revenue:utag.data["cp.yrd_dc_dep_amount"],transactionId:utag.data["cp.yrd_dc_ApplicationRef"],details:[{name:"Savings",sku:utag.data["cp.yrd_dc_prodTypeSavings"],quantity:"1",cost:utag.data["cp.yrd_dc_dep_amount"]}]}]);})();}}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:307");utag.DB(b);var c,d,e,f;u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"//d2hkbi3gan6yg6.cloudfront.net/visscore.tag.min.js","account_token":"c-a-sainsb-uk","send_details":"false","forward_param":[],"labels":[],"sync_ids":[],"product_name":[],"product_sku":[],"product_quantity":[],"product_unit_price":[],"event_name":"","custom":{}};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:307:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.map_func(e[f].split("."),u.data,b[d]);}}}
utag.DB("send:307:MAPPINGS");utag.DB(u.data);u.data.revenue=u.data.order_id||b._corder||"";u.data.transaction_id=u.data.order_total||b._ctotal||"";if(u.data.product_name.length===0&&b._cprodname!==undefined){u.data.product_name=b._cprodname.slice(0);}
if(u.data.product_sku.length===0&&b._csku!==undefined){u.data.product_sku=b._csku.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
if(!u.data.account_token){utag.DB(u.id+": Tag not fired: Required attribute not populated");return;}
vscr.push(["setAccount",u.data.account_token]);vscr.push(["addEndPoint","www.insurance-sainsburysbank.co.uk"]);if(typeof(u.data.forward_param)==="string"){u.data.forward_param=u.data.forward_param.split(",");}
if(u.data.forward_param.length!==0){for(var i=0;i<u.data.forward_param.length;i++){vscr.push(["addForwardParam",u.data.forward_param[i]]);}}
if(u.data.event_name){var evt=[];var data={};evt.push("addEvent");data.name=u.data.event_name;if(u.data.revenue){data.revenue=u.data.revenue;}
if(u.data.transaction_id){data.transactionId=u.data.transaction_id;}
if(u.data.send_details===true||u.data.send_details==="true"){var details=[];for(var j=0;j<u.data.product_name.length;j++){var item={};item.name=u.data.product_name[j];if(u.data.product_sku.length===u.data.product_name.length){item.sku=u.data.product_sku[j];}
if(u.data.product_quantity.length===u.data.product_name.length){item.quantity=u.data.product_quantity[j];}
if(u.data.product_unit_price.length===u.data.product_name.length){item.cost=u.data.product_unit_price[j];}
details.push(item);}
if(details.length!==0){data.details=details;}}
evt.push(data);vscr.push(evt);}
if(!u.isEmpty(u.data.labels)){for(var labelType in u.data.labels){for(var labelKey in u.data.labels[labelType]){vscr.push([labelType,labelKey,u.data.labels[labelType][labelKey]]);}}}
if(typeof(u.data.sync_ids)==="string"){u.data.sync_ids=u.data.sync_ids.split(",");}
if(u.data.sync_ids.length!==0){for(var i=0;i<u.data.sync_ids.length;i++){vscr.push(["addSyncId",u.data.sync_ids[i]]);}}
function yrd_readCookie(param){var b=document.cookie.match('(^|;)\\s*'+param+'\\s*=\\s*([^;]+)');return b?b.pop():'';}
function yrd_deleteCookie(name){if(document.cookie.indexOf(name)>-1){var expires=new Date();expires.setTime(expires.getTime()-1);expires=expires.toGMTString();document.cookie=name+"=; expires="+expires+"; path=/";}}
function yrd_cookieParse(name){var result=document.cookie.match(new RegExp(name+'=([^;]+)'));result&&(result=JSON.parse(result[1]));return result;}
function getParameterByName(name,url){if(!url)url=window.location.href;name=name.replace(/[\[\]]/g,'\\$&');var regex=new RegExp('[?&]'+name+'(=([^&#]*)|&|#|$)'),results=regex.exec(url);if(!results)return null;if(!results[2])return'';return decodeURIComponent(results[2].replace(/\+/g,' '));}
function yrd_setCookie(name,value,days){var expires="";if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toUTCString();}
document.cookie=name+"="+(value||"")+expires+"; path=/";}
function loan5kBands(loan_amount){if(loan_amount>=0&&loan_amount<5001)
return"£k-£5k";else if(loan_amount>=5001&&loan_amount<10001)
return"£5k-£10k";else if(loan_amount>=10001&&loan_amount<150001)
return"£10k-£15k";else if(loan_amount>=15001&&loan_amount<=20001)
return"£15k-£20k";else if(loan_amount>=20001&&loan_amount<=25001)
return"£20k-£25k";else if(loan_amount>=25001&&loan_amount<=30001)
return"£25k-£30k";else if(loan_amount>=30001&&loan_amount<=35001)
return"£30k-£35k";}
if(window.location.href.substring(window.location.protocol.length+2)=="www.sainsburysbank.co.uk/"){vscr.push(["addEvent",{name:"Home Page View"}])}else if(window.location.href.substring(window.location.protocol.length+2)=="www.sainsburysbank.co.uk/borrowing/bor_borrowing_zone"){vscr.push(["addEvent",{name:"Loans Zone Page View"}])}else if(location.pathname=="/mortgages/index"){vscr.push(["addEvent",{name:"Mortgages Zone Page View"}])}else if(location.pathname=="/credit-cards/index"){vscr.push(["addEvent",{name:"Credit Card Zone Page View"}])}else if(location.pathname=="/savings/sav_savings_zone"){vscr.push(["addEvent",{name:"Savings Zone Page View"}])}else if(location.pathname=="/insuring/ins_insuring_zone"){vscr.push(["addEvent",{name:"Insurance Zone Page View"}])}else if(location.pathname=="/travel/travel-zone"){vscr.push(["addEvent",{name:"Travel Zone Page View"}])}else if(location.pathname=="/doublenectar/index"){vscr.push(["addEvent",{name:"Nectar Zone Page View"}])}else if(location.pathname=="/servicing/register"){vscr.push(["addEvent",{name:"Register Loans"}])}else if(location.pathname=="/servicing/signin"){vscr.push(["addEvent",{name:"Loans Log In"}])}else if(location.pathname=="/loans/home-improvement-loans"){vscr.push(["addEvent",{name:"Home Improvement Loans Page View"}])}else if(location.pathname=="/loans/car-loans"){vscr.push(["addEvent",{name:"Car Loans Page View"}])}else if(location.pathname=="/borrowing/popup/bor_termsandconditions_loa_pop"){vscr.push(["addEvent",{name:"Loans Terms and Conditions Page View"}])}else if(location.pathname=="/borrowing/bor_loans_small_skip"){vscr.push(["addEvent",{name:"Loans Key Information Page View"}])}else if(window.location.href.substring(window.location.protocol.length+2).indexOf("www.sainsburysbank-eligibilitychecker.co.uk/")>-1&&window.location.href.substring(window.location.protocol.length+2)!="www.sainsburysbank-eligibilitychecker.co.uk/Results"){vscr.push(["addEvent",{name:"Loans Eligible Checker Page View"}])}else if(location.href.indexOf("servicing/servicing/loansapplication/shortapply")>-1){vscr.push(["addEvent",{name:"Loans Short Apply Page View"}])}else if(location.href.indexOf("servicing/servicing/product/loans")>-1){vscr.push(["addEvent",{name:"Loans Servicing Zone Page View"}])}else if(location.href.indexOf("servicing/servicing/loansapplication/landing")>-1){vscr.push(["addEvent",{name:"Loans Servicing Landing Page View"}])}else if(location.href.indexOf("loans/early-repayments")>-1){vscr.push(["addEvent",{name:"Loans Early Repayments Page View"}])}else if(location.href.indexOf("loans/checklist-applying-for-a-loan")>-1){vscr.push(["addEvent",{name:"Loans Applying Checklist Page View"}])}else if(location.href.indexOf("loans/overpayments")>-1){vscr.push(["addEvent",{name:"Loans Overpayments Page View"}])}else if(window.location.href.substring(window.location.protocol.length+2)=="www.sainsburysbank-eligibilitychecker.co.uk/Results"){var chance=document.getElementsByTagName("h2")[0].innerText||"NA"
vscr.push(["addEvent",{name:"Loans Eligibility Checker Results",labels:[{"name":"Result","type":"string","string_value":chance}]}])}else if(window.location.href.substring(window.location.protocol.length+2).indexOf("/borrowing/support/")>-1){var support_page=location.pathname
vscr.push(["addEvent",{name:"Loans Support Page View",labels:[{"name":"Support Page","type":"string","string_value":support_page}]}])}else if(window.location.href.substring(window.location.protocol.length+2).indexOf("www.sainsburysbank.co.uk/borrowing/bor_borrowing_zone?borrowing=")>-1){var borrowing=getParameterByName("borrowing").toString()
var term=getParameterByName("term").toString()
if(borrowing==""){borrowing="NA"}
if(term==""){term="NA"}
vscr.push(["addEvent",{name:"Loans Calculator Used",labels:[{"name":"Borrowing","type":"string","string_value":borrowing},{"name":"Term","type":"string","string_value":term}]}])}else if(window.location.href.substring(window.location.protocol.length+2).indexOf("sainsburysbank.co.uk/borrowing/sainsburys_loan_calculator_eligibility?")>-1){var borrowing=getParameterByName("la")||0;var term=(getParameterByName("t")+" Months").toString()
var nectar=getParameterByName("pcat").toString()
if(term==""){term="NA"}
if(nectar==""){nectar="NA"}
vscr.push(["addEvent",{name:"Loans Application Step 1",labels:[{"name":"Nectar","type":"string","string_value":nectar},{"name":"Term","type":"string","string_value":term}],details:[{name:"Loan",sku:"",quantity:1,cost:borrowing,category:term}]}])}else if(window.location.href.substring(window.location.protocol.length+2).indexOf("online.sainsburysbank.co.uk/apply/apply/getstarted/loangetstarted")>-1){vscr.push(["addEvent",{name:"Loans Application Step 2",}])}else if(window.location.href.substring(window.location.protocol.length+2)=="online.sainsburysbank.co.uk/apply/apply/LoanApplication#/yourdetails"){vscr.push(["addEvent",{name:"Loans Application Step 3",}])}
function locationHashChanged(){if(location.hash=="#tab--will-i-be-approved-"){vscr.push(["addEvent",{name:"Loans Will I Be Approved Page View"}])
vscr.push(["fire"])}else if(location.hash=="#tab--top-upyour-loan-"){vscr.push(["addEvent",{name:"Loans Top Up Your Loan Page View"}])
vscr.push(["fire"])}else if(location.hash=="#tab--tools-andguides-"){vscr.push(["addEvent",{name:"Loans Tools and Guides Page View"}])
vscr.push(["fire"])}else if(location.hash=="#/benefits"){vscr.push(["addEvent",{name:"Loans Application Step 4"}])
vscr.push(["fire"])}}
window.onhashchange=locationHashChanged;if(/\/apply\/(loanpaperoffer|loanoffer)|\/apply\/LoanApplication#\/loanOffer/.test(location.href)||/\/apply\/(loanapplication|loanpaperoffer)\/decline/.test(location.pathname)||/\/apply\/(loanapplication|loanpaperoffer)\/refer/.test(location.pathname)){var form_name='';var decision='';var application_id=''
var application_type='Standard'
var loan_amount=yrd_readCookie("yrd_loan_amount").toString()
var loan_band=loan5kBands(Number(loan_amount));var product=yrd_readCookie("yrd_product")||"Loan"
var term=yrd_readCookie("yrd_loan_term").toString()
var price=utag.data["cp.yrd_total_repayable"]-$(".rep-odd").find("[for^=LoanAmount]").next().text().trim().replace("£","").replace(",","")
var apr=yrd_readCookie("yrd_apr").toString()
var nectar=yrd_readCookie("yrd_nectar_no")
var nectar_flag="Non-Nectar";if(nectar){nectar_flag="Nectar";}
var purpose=yrd_readCookie("yrd_loan_purpose").toString()
if(location.pathname.indexOf("accept")>-1){form_name="Loans: Application Complete";desicion="Loans - Accept";}else if(location.pathname.indexOf("decline")>-1){form_name="Loans: Application Decline";desicion="Loans - Decline";}else if(location.pathname.indexOf("refer")>-1){form_name="Loans: Application Refer";desicion="Loans - Refer";}else if(location.href.indexOf("loanOffer")>-1){form_name="Loans: Application Decision";desicion="Loans - Accept";}else{form_name="NA";desicion="NA";}
var labels_info=[];if(typeof purpose=="string"&&purpose!=""){label_fill={"name":"Purpose","type":"string","string_value":purpose}
labels_info.push(label_fill)}
if(typeof term=="string"&&term!=""){label_fill={"name":"Term","type":"string","string_value":term}
labels_info.push(label_fill)}
if(typeof decision=="string"&&decision!=""){label_fill={"name":"Desicion","type":"string","string_value":desicion}
labels_info.push(label_fill)}
if(typeof loan_amount=="string"&&loan_amount!=""){label_fill={"name":"Loan Amount","type":"string","string_value":loan_amount}
labels_info.push(label_fill)}
if(typeof apr=="string"&&apr!=""){label_fill={"name":"APR","type":"string","string_value":apr}
labels_info.push(label_fill)}
if(typeof form_name=="string"&&form_name!=""){label_fill={"name":"Form Name","type":"string","string_value":form_name}
labels_info.push(label_fill)}
if(typeof nectar_flag=="string"&&nectar_flag!=""){label_fill={"name":"Nectar","type":"string","string_value":nectar_flag}
labels_info.push(label_fill)}
if(typeof application_type=="string"&&application_type!=""){label_fill={"name":"Application Type","type":"string","string_value":application_type}
labels_info.push(label_fill)}
vscr.push(["addEvent",{name:"Loans Application Complete Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])
if(/\/apply\/(loanpaperoffer|loanoffer)|\/apply\/LoanApplication#\/loanOffer/.test(location.href)){vscr.push(["addEvent",{name:"Loans Application Accept Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])}else if(/\/apply\/(loanapplication|loanpaperoffer)\/decline/.test(location.pathname)){vscr.push(["addEvent",{name:"Loans Application Decline Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])}else if(/\/apply\/(loanapplication|loanpaperoffer)\/refer/.test(location.pathname)){vscr.push(["addEvent",{name:"Loans Application Refer Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])}}
if(/\/servicing\/loansapplication\/declined/.test(location.pathname)||/\/servicing\/loanpaperoffer/.test(location.pathname)||/\/servicing\/loansapplication\/offer\//.test(location.pathname)||/\/servicing\/loansapplication\/referred/.test(location.pathname)){var form_name='';var decision='';var application_id=''
var application_type='Short Apply'
if(/\/servicing\/loansapplication\/declined/.test(location.pathname)){form_name="Loans: Short Application Decline";desicion="Loans - Decline";}else if(/\/servicing\/loanpaperoffer/.test(location.pathname)){form_name="Loans: Short Application Paper Offer";desicion="Loans - Accept";}else if(/\/servicing\/loansapplication\/referred/.test(location.pathname)){form_name="Loans: Short Application Refer";desicion="Loans - Refer";}else if(/\/servicing\/loansapplication\/offer\//.test(location.pathname)){form_name="Loans: Short Application Decision";desicion="Loans - Accept";}else{form_name="NA";desicion="NA";}
var loan_amount=yrd_readCookie("yrd_loan_amount").toString()
var loan_band=loan5kBands(Number(loan_amount));var product=yrd_readCookie("yrd_product")||"Loan"
var term=yrd_readCookie("yrd_term_of_loan").toString()
var price=yrd_readCookie("yrd_total_repayable")||yrd_readCookie("yrd_loan_amount")
var apr=yrd_readCookie("yrd_loan_apr").toString()
var nectar=yrd_readCookie("yrd_nectar_flag")
var nectar_flag="Non-Nectar";if(nectar){nectar_flag="Nectar";}
var purpose=yrd_readCookie("yrd_loan_purpose").toString()
var labels_info=[];if(typeof purpose=="string"&&purpose!=""){label_fill={"name":"Purpose","type":"string","string_value":purpose}
labels_info.push(label_fill)}
if(typeof term=="string"&&term!=""){label_fill={"name":"Term","type":"string","string_value":term}
labels_info.push(label_fill)}
if(typeof decision=="string"&&decision!=""){label_fill={"name":"Desicion","type":"string","string_value":desicion}
labels_info.push(label_fill)}
if(typeof loan_amount=="string"&&loan_amount!=""){label_fill={"name":"Loan Amount","type":"string","string_value":loan_amount}
labels_info.push(label_fill)}
if(typeof apr=="string"&&apr!=""){label_fill={"name":"APR","type":"string","string_value":apr}
labels_info.push(label_fill)}
if(typeof form_name=="string"&&form_name!=""){label_fill={"name":"Form Name","type":"string","string_value":form_name}
labels_info.push(label_fill)}
if(typeof nectar_flag=="string"&&nectar_flag!=""){label_fill={"name":"Nectar","type":"string","string_value":nectar_flag}
labels_info.push(label_fill)}
if(typeof application_type=="string"&&application_type!=""){label_fill={"name":"Application Type","type":"string","string_value":application_type}
labels_info.push(label_fill)}
vscr.push(["addEvent",{name:"Loans Application Complete Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])
if(/\/servicing\/loansapplication\/declined/.test(location.pathname)){vscr.push(["addEvent",{name:"Loans Application Decline Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])}else if(/\/servicing\/loanpaperoffer/.test(location.pathname)){vscr.push(["addEvent",{name:"Loans Application Accept Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])}else if(/\/servicing\/loansapplication\/referred/.test(location.pathname)){vscr.push(["addEvent",{name:"Loans Application Refer Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])}else if(/\/servicing\/loansapplication\/offer\//.test(location.pathname)){vscr.push(["addEvent",{name:"Loans Application Accept Sale",revenue:price,details:[{name:product,sku:loan_band,quantity:1,cost:price,labels:labels_info}]}])}}if(/pet-insurance/.test(location.href)||/pet.sainsburysbank.co.uk/.test(location.href)){if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/index"){vscr.push(["addEvent",{name:"Pet Insurance Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/dog"){vscr.push(["addEvent",{name:"Pet Insurance Dog Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/cat"){vscr.push(["addEvent",{name:"Pet Insurance Cat Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/multi-pet-insurance"){vscr.push(["addEvent",{name:"Pet Insurance Multi Pet Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/helpful-guides"){vscr.push(["addEvent",{name:"Pet Insurance Guides Page View"}])
var links=document.querySelectorAll(".headingStyle4");links.forEach(function(el){el.addEventListener('click',function(){vscr.push(["addEvent",{name:"Pet Insurance Guides Click"}])
vscr.push(["fire"])})})}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/support/support-ins-pet-claim-new"){vscr.push(["addEvent",{name:"Pet Insurance Support"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/support/support-ins-pet-policy-new"){vscr.push(["addEvent",{name:"Pet Insurance Policies"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/loss-cover"){vscr.push(["addEvent",{name:"Pet Insurance - Loss Cover Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/safe-return-cover"){vscr.push(["addEvent",{name:"Pet Insurance - Safe Return Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/pet-insurance/holiday-cover"){vscr.push(["addEvent",{name:"Pet Insurance - Holiday Cover Page View"}])}else if(location.href.substring(location.protocol.length+2)=="pet.sainsburysbank.co.uk/quote/index.asp"){vscr.push(["addEvent",{name:"Pet Insurance Step 1"}])}else if(location.pathname=="/quote/your-quote.asp"){vscr.push(["addEvent",{name:"Pet Insurance Step 2",details:[{name:b['cp.bt_petType']+" Insurance",sku:"",quantity:1,cost:""}]}])}else if(location.pathname=="/quote/more-details.asp"){vscr.push(["addEvent",{name:"Pet Insurance Step 3",details:[{name:utag.data['cp.bt_petType']+" Insurance",sku:"",quantity:1,cost:$('.table th:contains("per year")').text().replace(/[^0-9\.]/g,'').trim()}]}])}else if(location.pathname=="/quote/Payment.asp"){vscr.push(["addEvent",{name:"Pet Insurance Step 4",details:[{name:utag.data['cp.bt_petType']+" Insurance",sku:"",quantity:1,cost:$('.price:eq(0)').text().replace("£","").replace(/[^0-9\.]/g,'').trim()}]}])}else if(location.pathname=="/quote/confirmation.asp"){vscr.push(["addEvent",{name:"Pet Insurance Sale",revenue:utag.data['cp.BT_price'].replace("£","").replace(/[^0-9\.]/g,''),transactionId:utag.data['cp.yrd_petPolicy'],details:[{name:utag.data['cp.bt_petType']+" Insurance",sku:"",quantity:1,cost:utag.data['cp.BT_price'].replace("£","").replace(/[^0-9\.]/g,'')}]}])}}
function HIlocationHashChanged(){if(location.hash=="#tab--optional-extras-"){vscr.push(["addEvent",{name:"Home Insurance Optional Extras"}])
vscr.push(["fire"])}else if(location.hash=="#tab--whats-included-"){vscr.push(["addEvent",{name:"Home Insurance - Whats Included"}])
vscr.push(["fire"])}else if(location.hash=="#tab--existing-customers-"){vscr.push(["addEvent",{name:"Home Insurance - Exisiting Customers"}])
vscr.push(["fire"])}else if(location.hash=="#tab--guides-"){vscr.push(["addEvent",{name:"Home Insurance - Guide"}])
vscr.push(["fire"])}else if(location.hash=="#accordion-item-1-1"){vscr.push(["addEvent",{name:"Home Insurance - Terms and Conditions"}])
vscr.push(["fire"])}}
if(/home-insurance|homeinsurance.sainsburysbank.co.uk|sainsburysbankcdltest.uatproxy.cdlis.co.uk/.test(location.href)){var hiType="";if(typeof utag.data['cp.yd_startDate']!="undefined"&&/yd_type[^|]+/.test(utag.data['cp.yd_startDate'])){hiType=utag.data['cp.yd_startDate'].match(/yd_type[^|]+/)[0].replace('yd_type=','');if(hiType!=""){if(hiType=="CB"||/Buildings and contents/i.test(hiType)){hiType="Contents and Building"}else if(hiType=="B"){hiType="Building"}else if(hiType=="C"){hiType="Contents"}}else if(hiType==""){hiType="NA";}}
if(hiType==""){hiType="NA"}
var page=location.href.substr(location.href.lastIndexOf('/')+1)
if(location.href.substring(location.protocol.length+2)=='www.sainsburysbank.co.uk/home-insurance/index'){vscr.push(["addEvent",{name:"Home Insurance Page View"}])
window.onhashchange=HIlocationHashChanged;}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/emergency-cover"){vscr.push(["addEvent",{name:"Home Insurance - Emergency Cover Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/family-legal-protection"){vscr.push(["addEvent",{name:"Home Insurance - Family Legal Protection Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/personal-possessions"){vscr.push(["addEvent",{name:"Home Insurance - Personal Possessions Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/keycare"){vscr.push(["addEvent",{name:"Home Insurance - Keycare Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/bicycle-cover-out-of-home"){vscr.push(["addEvent",{name:"Home Insurance - Bicycle Cover Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/enhanced-accidental-damage-cover-content"){vscr.push(["addEvent",{name:"Home Insurance - Accidental Cover Content Page View"}])}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/enhanced-accidental-damage-cover-buildings"){vscr.push(["addEvent",{name:"Home Insurance - Accidental Cover Buildings Page View"}])}else if(/www.sainsburysbank.co.uk\/home\-insurance\/faq/.test(location.href)){if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/faq"){vscr.push(["addEvent",{name:"Home Insurance - FAQ"}])}else{vscr.push(["addEvent",{name:"Home Insurance - FAQ",details:[{name:page}]}])}}else if(location.href.substring(location.protocol.length+2)=="www.sainsburysbank.co.uk/home-insurance/get-a-quote"){vscr.push(["addEvent",{name:"Home Insurance - Get A Quote Page View"}])}else if(document.title=="About your property"){vscr.push(["addEvent",{name:"Home Insurance Step 1"}])}else if(document.title=="About you"){vscr.push(["addEvent",{name:"Home Insurance Step 2",details:[{name:hiType,sku:"",quantity:1,cost:utag.data["cp.yd_annualValue"]}]}])}else if(document.title=="Quote details"){vscr.push(["addEvent",{name:"Home Insurance Step 3",details:[{name:hiType,sku:"",quantity:1,cost:utag.data["cp.yd_annualValue"]}]}])}else if(document.title=="Card payment"){vscr.push(["addEvent",{name:"Home Insurance Step 4"}])}else if(document.title=="Account registration"){vscr.push(["addEvent",{name:"Home Insurance Sale",revenue:utag.data["cp.yd_annualValue"]||dataLayer[0].annual_quote_total.replace(/[^0-9\.]/g,''),transactionId:utag.data['cp.yd_referenceNo'],details:[{name:utag.data['cp.yd_productType'],sku:"",quantity:1,cost:utag.data["cp.yd_annualValue"]||dataLayer[0].annual_quote_total.replace(/[^0-9\.]/g,'')}]}])}}
vscr.push(["addIgnoredURL","arcot.com"])
vscr.push(["addIgnoredURL","lloydstsb.com"])
vscr.push(["addIgnoredURL","barclaycard.co.uk"])
vscr.push(["addIgnoredURL","mycardsecure.com"])
vscr.push(["addIgnoredURL","verifiedbyvisa.com"])
vscr.push(["addIgnoredURL","quote-link.net"])
vscr.push(["setSessionOverride",false])
setTimeout(function(){vscr.push(["fire"]);},500);function validation(email){var re=/\S+@\S+\.\S+/;return re.test(email);}
var email="";var mobileNumber="";var nectar_no="";var allLinks=document.querySelectorAll("a");var selectorLinks=[]
for(var a=0;a<allLinks.length;a++){if(allLinks[a].textContent=='Continue'){selectorLinks.push(allLinks[a])}else if(allLinks[a].textContent=='Next step'){selectorLinks.push(allLinks[a])}}
var buttons=[].slice.call(document.querySelectorAll("button.next, button.back"));var selectors=selectorLinks.concat(buttons);for(var x=0;x<selectors.length;x++){selectors[x].addEventListener("click",function(){email=document.getElementById('EmailAddress')||document.getElementById('strCustEmail')||document.getElementById('ProposerEmail')||"";if(email!=""&&email!=null){email=email.value}
mobileNumber=document.getElementById('MobileNumber')||document.getElementById('mobile_number')||document.getElementById('ProposerDayTel')||"";if(mobileNumber!=""&&mobileNumber!=null){mobileNumber=mobileNumber.value}
nectar_no=document.getElementById('NectarCardNumber')||document.getElementById('nectar_card_number')||document.getElementById('nectar_card_number2')||"";if(nectar_no!=""&&nectar_no!=null){nectar_no=nectar_no.value}
if(typeof(email)!="undefined"&&email!=""&&validation(email)){vscr.push(["addSyncId",email])}
if(typeof(mobileNumber)!="undefined"&&mobileNumber.length==11&&/^\d+$/.test(mobileNumber)){vscr.push(["addSyncId",mobileNumber])}
if(typeof(nectar_no)!="undefined"&&nectar_no!=""){vscr.push(["addSyncId",nectar_no])}
vscr.push(["fire"])});}
u.loader({"type":"script","src":u.data.base_url,"cb":null,"loc":"script","id":"utag_307","attrs":{}});utag.DB("send:307:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("307","sainsburysbank.main"));}catch(error){utag.DB(error);}
